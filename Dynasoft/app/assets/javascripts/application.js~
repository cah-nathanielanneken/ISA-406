//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require_tree .

$(document).ready(function() {
    if (localStorage.getItem("scrollVal") != null) {
	$(window).scrollTop(localStorage.getItem("scrollVal"));
	localStorage.setItem("scrollVal", 0);
    }

    $(".edit_room").submit(function(e) {
        var x = parseInt($(this).find( 'input#room_occupancy')[0].value);
        var y = parseInt($(this).find( 'input#room_maxOccupancy')[0].value);
        if (x > y || x < 0) {
            alert("Occupancy is not allowed to be greater than Max Occupancy or negative!");
            e.preventDefault();
        }
    });

    $(".main-button").click(function(e) {
      localStorage.setItem("scrollVal", $(window).scrollTop());
      var element = $(this);
      setTimeout(function() {
	if ($(element.attr("data-target")).find("#room_occupancy")[0].value == 0) {
          $(element.attr("data-target")).find("#room_occupancy")[0].value = '';
	}
	$(element.attr("data-target")).find("#room_occupancy")[0].focus();
      }, 200);
    });

    $( ".sort-wrap > ul" ).each(function() {
      $(this).sortable();
    });

    $( "#submit-form" ).click(function(e) {
      var arr1 = $("#sortable-0").sortable("toArray");
      var arr2 = $("#sortable-1").sortable("toArray");
      var arr3 = $("#sortable-2").sortable("toArray");
      for (var i = 0; i < arr1.length; i++) {
	$( "#"+arr1[i]+" input:last-child" ).val(i);
      }
      for (var i = 0; i < arr2.length; i++) {
	$( "#"+arr2[i]+" input:last-child" ).val(i);
      }
      for (var i = 0; i < arr3.length; i++) {
	$( "#"+arr3[i]+" input:last-child" ).val(i);
      }
      $( "#rooms-form" ).submit();
    });

});
